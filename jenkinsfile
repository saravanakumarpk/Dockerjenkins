pipeline{
  agent any
  stages{
    stage('Build'){
          steps {
            sh 'mvn clean compile package'
          }
          post {
            success {
                  echo 'Now archiving...'
                  archiveArtifacts artifacts: 'target/*.war'
                  }
                }
    }
        stage('BuildDockerimage'){
          steps {
		  script{
		  def app
            app = docker.build("saravanapk94/samplewar")
			docker.withRegistry('https://registry.hub.docker.com', 'docker-hub')
			app.push("${env.BUILD_NUMBER}")
                }
        }
		}
		}
	}
        
